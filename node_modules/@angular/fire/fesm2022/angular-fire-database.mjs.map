{"version":3,"file":"angular-fire-database.mjs","sources":["../../../src/database/database.ts","../../../src/database/database.module.ts","../../../src/database/rxfire.ts","../../../src/database/firebase.ts","../../../src/database/angular-fire-database.ts"],"sourcesContent":["import { ɵgetAllInstancesOf } from '@angular/fire';\nimport { Database as FirebaseDatabase } from 'firebase/database';\nimport { from, timer } from 'rxjs';\nimport { concatMap, distinct } from 'rxjs/operators';\n\n// see notes in core/firebase.app.module.ts for why we're building the class like this\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface Database extends FirebaseDatabase {}\n\nexport class Database {\n  constructor(database: FirebaseDatabase) {\n    return database;\n  }\n}\n\nexport const DATABASE_PROVIDER_NAME = 'database';\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface DatabaseInstances extends Array<FirebaseDatabase> {}\n\nexport class DatabaseInstances {\n  constructor() {\n    return ɵgetAllInstancesOf<FirebaseDatabase>(DATABASE_PROVIDER_NAME);\n  }\n}\n\nexport const databaseInstance$ = timer(0, 300).pipe(\n  concatMap(() => from(ɵgetAllInstancesOf<FirebaseDatabase>(DATABASE_PROVIDER_NAME))),\n  distinct(),\n);\n","import {\n  EnvironmentProviders,\n  InjectionToken,\n  Injector,\n  NgModule,\n  NgZone,\n  Optional,\n  makeEnvironmentProviders,\n} from '@angular/core';\nimport { VERSION, ɵAngularFireSchedulers, ɵgetDefaultInstanceOf } from '@angular/fire';\nimport { ɵAppCheckInstances } from '@angular/fire';\nimport { FirebaseApp, FirebaseApps } from '@angular/fire/app';\nimport { AuthInstances } from '@angular/fire/auth';\nimport { registerVersion } from 'firebase/app';\nimport { Database as FirebaseDatabase } from 'firebase/database';\nimport { DATABASE_PROVIDER_NAME, Database, DatabaseInstances } from './database';\n\nexport const PROVIDED_DATABASE_INSTANCES = new InjectionToken<Database[]>('angularfire2.database-instances');\n\nexport function defaultDatabaseInstanceFactory(provided: FirebaseDatabase[]|undefined, defaultApp: FirebaseApp) {\n  const defaultDatabase = ɵgetDefaultInstanceOf<FirebaseDatabase>(DATABASE_PROVIDER_NAME, provided, defaultApp);\n  return defaultDatabase && new Database(defaultDatabase);\n}\n\nexport function databaseInstanceFactory(fn: (injector: Injector) => FirebaseDatabase) {\n  return (zone: NgZone, injector: Injector) => {\n    const database = zone.runOutsideAngular(() => fn(injector));\n    return new Database(database);\n  };\n}\n\nconst DATABASE_INSTANCES_PROVIDER = {\n  provide: DatabaseInstances,\n  deps: [\n    [new Optional(), PROVIDED_DATABASE_INSTANCES ],\n  ]\n};\n\nconst DEFAULT_DATABASE_INSTANCE_PROVIDER = {\n  provide: Database,\n  useFactory: defaultDatabaseInstanceFactory,\n  deps: [\n    [new Optional(), PROVIDED_DATABASE_INSTANCES ],\n    FirebaseApp,\n  ]\n};\n\n@NgModule({\n  providers: [\n    DEFAULT_DATABASE_INSTANCE_PROVIDER,\n    DATABASE_INSTANCES_PROVIDER,\n  ]\n})\nexport class DatabaseModule {\n  constructor() {\n    registerVersion('angularfire', VERSION.full, 'rtdb');\n  }\n}\n\nexport function provideDatabase(fn: (injector: Injector) => FirebaseDatabase, ...deps: any[]): EnvironmentProviders {\n  registerVersion('angularfire', VERSION.full, 'rtdb');\n  return makeEnvironmentProviders([\n    DEFAULT_DATABASE_INSTANCE_PROVIDER,\n    DATABASE_INSTANCES_PROVIDER,\n    {\n      provide: PROVIDED_DATABASE_INSTANCES,\n      useFactory: databaseInstanceFactory(fn),\n      multi: true,\n      deps: [\n        NgZone,\n        Injector,\n        ɵAngularFireSchedulers,\n        FirebaseApps,\n        // Database+Auth work better if Auth is loaded first\n        [new Optional(), AuthInstances ],\n        [new Optional(), ɵAppCheckInstances ],\n        ...deps,\n      ]\n    }\n  ]);\n}\n","// DO NOT MODIFY, this file is autogenerated by tools/build.ts\nimport { ɵzoneWrap } from '@angular/fire';\nimport {\n  auditTrail as _auditTrail,\n  changeToData as _changeToData,\n  fromRef as _fromRef,\n  list as _list,\n  listVal as _listVal,\n  object as _object,\n  objectVal as _objectVal,\n  stateChanges as _stateChanges\n} from 'rxfire/database';\n\nexport {\n  ListenEvent,\n  ListenerMethods\n} from 'rxfire/database';\n\nexport const auditTrail = ɵzoneWrap(_auditTrail, true);\nexport const changeToData = ɵzoneWrap(_changeToData, true);\nexport const fromRef = ɵzoneWrap(_fromRef, true);\nexport const list = ɵzoneWrap(_list, true);\nexport const listVal = ɵzoneWrap(_listVal, true);\nexport const object = ɵzoneWrap(_object, true);\nexport const objectVal = ɵzoneWrap(_objectVal, true);\nexport const stateChanges = ɵzoneWrap(_stateChanges, true);\n","// DO NOT MODIFY, this file is autogenerated by tools/build.ts\nexport * from 'firebase/database';\nimport { ɵzoneWrap } from '@angular/fire';\nimport {\n  child as _child,\n  connectDatabaseEmulator as _connectDatabaseEmulator,\n  enableLogging as _enableLogging,\n  endAt as _endAt,\n  endBefore as _endBefore,\n  equalTo as _equalTo,\n  forceLongPolling as _forceLongPolling,\n  forceWebSockets as _forceWebSockets,\n  get as _get,\n  getDatabase as _getDatabase,\n  goOffline as _goOffline,\n  goOnline as _goOnline,\n  increment as _increment,\n  limitToFirst as _limitToFirst,\n  limitToLast as _limitToLast,\n  off as _off,\n  onChildAdded as _onChildAdded,\n  onChildChanged as _onChildChanged,\n  onChildMoved as _onChildMoved,\n  onChildRemoved as _onChildRemoved,\n  onDisconnect as _onDisconnect,\n  onValue as _onValue,\n  orderByChild as _orderByChild,\n  orderByKey as _orderByKey,\n  orderByPriority as _orderByPriority,\n  orderByValue as _orderByValue,\n  push as _push,\n  query as _query,\n  ref as _ref,\n  refFromURL as _refFromURL,\n  remove as _remove,\n  runTransaction as _runTransaction,\n  serverTimestamp as _serverTimestamp,\n  set as _set,\n  setPriority as _setPriority,\n  setWithPriority as _setWithPriority,\n  startAfter as _startAfter,\n  startAt as _startAt,\n  update as _update\n} from 'firebase/database';\n\nexport const child = ɵzoneWrap(_child, true);\nexport const connectDatabaseEmulator = ɵzoneWrap(_connectDatabaseEmulator, true);\nexport const enableLogging = ɵzoneWrap(_enableLogging, true);\nexport const endAt = ɵzoneWrap(_endAt, true);\nexport const endBefore = ɵzoneWrap(_endBefore, true);\nexport const equalTo = ɵzoneWrap(_equalTo, true);\nexport const forceLongPolling = ɵzoneWrap(_forceLongPolling, true);\nexport const forceWebSockets = ɵzoneWrap(_forceWebSockets, true);\nexport const get = ɵzoneWrap(_get, true);\nexport const getDatabase = ɵzoneWrap(_getDatabase, true);\nexport const goOffline = ɵzoneWrap(_goOffline, true);\nexport const goOnline = ɵzoneWrap(_goOnline, true);\nexport const increment = ɵzoneWrap(_increment, true);\nexport const limitToFirst = ɵzoneWrap(_limitToFirst, true);\nexport const limitToLast = ɵzoneWrap(_limitToLast, true);\nexport const off = ɵzoneWrap(_off, true);\nexport const onChildAdded = ɵzoneWrap(_onChildAdded, true);\nexport const onChildChanged = ɵzoneWrap(_onChildChanged, true);\nexport const onChildMoved = ɵzoneWrap(_onChildMoved, true);\nexport const onChildRemoved = ɵzoneWrap(_onChildRemoved, true);\nexport const onDisconnect = ɵzoneWrap(_onDisconnect, true);\nexport const onValue = ɵzoneWrap(_onValue, true);\nexport const orderByChild = ɵzoneWrap(_orderByChild, true);\nexport const orderByKey = ɵzoneWrap(_orderByKey, true);\nexport const orderByPriority = ɵzoneWrap(_orderByPriority, true);\nexport const orderByValue = ɵzoneWrap(_orderByValue, true);\nexport const push = ɵzoneWrap(_push, true);\nexport const query = ɵzoneWrap(_query, true);\nexport const ref = ɵzoneWrap(_ref, true);\nexport const refFromURL = ɵzoneWrap(_refFromURL, true);\nexport const remove = ɵzoneWrap(_remove, true);\nexport const runTransaction = ɵzoneWrap(_runTransaction, true);\nexport const serverTimestamp = ɵzoneWrap(_serverTimestamp, true);\nexport const set = ɵzoneWrap(_set, true);\nexport const setPriority = ɵzoneWrap(_setPriority, true);\nexport const setWithPriority = ɵzoneWrap(_setWithPriority, true);\nexport const startAfter = ɵzoneWrap(_startAfter, true);\nexport const startAt = ɵzoneWrap(_startAt, true);\nexport const update = ɵzoneWrap(_update, true);\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["ɵgetAllInstancesOf","ɵgetDefaultInstanceOf","ɵAngularFireSchedulers","ɵAppCheckInstances","ɵzoneWrap","_auditTrail","_changeToData","_fromRef","_list","_listVal","_object","_objectVal","_stateChanges","_child","_connectDatabaseEmulator","_enableLogging","_endAt","_endBefore","_equalTo","_forceLongPolling","_forceWebSockets","_get","_getDatabase","_goOffline","_goOnline","_increment","_limitToFirst","_limitToLast","_off","_onChildAdded","_onChildChanged","_onChildMoved","_onChildRemoved","_onDisconnect","_onValue","_orderByChild","_orderByKey","_orderByPriority","_orderByValue","_push","_query","_ref","_refFromURL","_remove","_runTransaction","_serverTimestamp","_set","_setPriority","_setWithPriority","_startAfter","_startAt","_update"],"mappings":"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"}